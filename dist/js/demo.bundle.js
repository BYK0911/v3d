!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class r{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}matrix(t,e,i,r,s,n,o,h,a,l,c,d){let{x:u,y:p,z:g}=this;this.x=t*u+e*p+i*g+r,this.y=s*u+n*p+o*g+h,this.z=a*u+l*p+c*g+d}translate(t=0,e=0,i=0){this.x+=t,this.y+=e,this.z+=i}rotate(t=0){t=t/180*Math.PI;let e=Math.cos(t),i=Math.sin(t);this.matrix(e,i,0,0,-i,e,0,0,0,0,1,0)}rotateX(t=0){t=t/180*Math.PI;let e=Math.cos(t),i=Math.sin(t);this.matrix(1,0,0,0,0,e,i,0,0,-i,e,0)}rotateY(t=0){t=t/180*Math.PI;let e=Math.cos(t),i=Math.sin(t);this.matrix(e,0,-i,0,0,1,0,0,i,0,e,0)}}var s=function(t,e,i){return new r(t,e,i)};var n=class{constructor(){this.dom=document.createElement("canvas"),this.ctx=this.dom.getContext("2d")}polyline(t){t.forEach((t,e)=>{0===e?this.ctx.moveTo(...t):this.ctx.lineTo(...t)})}polygone(t){this.ctx.beginPath(),this.polyline(t),this.ctx.closePath()}};function o(t=[]){let e=t.length;if(e<=1)return t;if(e=2){let[[e,i],[r,s]]=t;return e*s-i*r}{let i=0,r=0;for(;i<e;)r+=h(t,0,i);return r}}function h(t,e,i){return 0===t[e][i]?0:Math.pow(-1,e+i)*t[e][i]*o(a(t,e,i))}function a(t,e,i){let r=t.length,s=[];for(let n=0;n<r;n++){if(n===e)continue;let o=[];for(let e=0;e<r;e++)e!==i&&o.push(t[n][e]);s.push(o)}return s}var l={det:o,A:h,M:a};let{A:c}=l;var d={add(...t){let e=[];return t.forEach(t=>{t.forEach((t,i)=>{e[i]=e[i]?e[i]+t:t})}),e},minus(t,e){let i=[...t];e.forEach((t,e)=>{i[e]=(i[e]||0)-t})},norm(t){if(0!==t.length)return Math.sqrt(t.reduce((t,e)=>t+e*e,0))},dot(t,e){let i=Math.min(t.length,e.length),r=0,s=-1;for(;++s<i;)r+=t[s]*e[s];return r},cross(t,e){let[i,r,s]=t,[n,o,h]=e;void 0===s&&(s=0),void 0===h&&(h=0);let a=[[1,1,1],[i,r,s],[n,o,h]];return[c(a,0,0),c(a,0,1),c(a,0,2)]},scale:(t,e)=>t.map(t=>t*e),cos(t,e){let i=this.norm(t),r=this.norm(e);return i&&r?this.dot(t,e)/i/r:1},sin(t,e){let i=this.norm(t),r=this.norm(e);return i&&r?this.norm(this.cross(t,e))/i/r:1},normalVector(t){let e=[0,0,0],i=-1;for(t=[...t,t[0]];++i<t.length-1;)e=this.add(e,this.cross(t[i],t[i+1]));return e}};const u={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15};var p=function(t){let e,i,r,s=1;if("#"===t[0]){let s=t.slice(1);3===s.length&&(s=`${s[0]}${s[0]}${s[1]}${s[1]}${s[2]}${s[2]}`),e=16*u[s[0]]+u[s[1]],i=16*u[s[2]]+u[s[3]],r=16*u[s[4]]+u[s[5]]}else t.match(/rgba/)?[e,i,r,s]=t.slice(5,-1).split(/,\s*/g):[e,i,r]=t.slice(4,-1).split(/,\s*/g);return{r:e,g:i,b:r,a:s}};var g=class{constructor(){this.x=0,this.y=0,this.fill="rgba(255, 255, 255, 0)",this.stroke="rgba(0, 0, 0, .5)",this.lineWidth=1}render(){}setPosition(t,e){this.x=t,this.y=e}};const f=[],m={linear:t=>t,ease:t=>t*t,easeOut:t=>Math.sqrt(t)};class y{constructor(){this.duration=300,this.delay=0,this.timingFunction="ease",this.data=null,this.timeStart=null,this.playing=!1,this.timePaused=null,this.loop=1,this.direction="normal"}run(){let t=+new Date;if(t-this.timeStart>this.delay){let e,i=(t-this.timeStart-this.delay)/this.duration,r=this.timingFunction,{obj:s,originalStatus:n,deltas:o}=this.data;i>1&&(--this.loop?(i-=1,this.timeStart+=this.duration):(i=1,f.splice(f.indexOf(this),1),this.playing=!1)),"string"==typeof r&&(r=m[r]||m.ease),e=r(i);for(let t in o)s[t]=n[t]+o[t]*e}}play(){return!this.playing&&this.loop>0&&(this.playing=!0,this.timeStart||(this.timeStart=+new Date),this.timePaused&&(this.timeStart+=+new Date-this.timePaused),f.push(this),1===f.length&&x()),this}pause(){return this.playing&&(f.splice(f.indexOf(this),1),this.playing=!1,this.timePaused=+new Date),this}delay(t=0){return this.delay=t,this}loop(t=1){return this.loop=t,this}restart(t){this.loop=t?Math.max(t,1):Math.max(this.loop,1),this.timeStart=null,this.timePaused=null,this.play()}}function x(){f.length&&requestAnimationFrame(x),f.forEach(t=>{t.run()})}var w={Scene:class{constructor(){this.x=0,this.y=0,this.width=500,this.height=300,this.rotationX=0,this.rotationZ=0,this.perspective=100,this.light=[1,1,1],this.backgroundColor="rgba(255, 255, 255, 0)",this.elements=[],this.renderer=new n}render(){window.requestAnimationFrame(()=>this.render());let t=this.getRenderElements();this.renderer.ctx.clearRect(0,0,this.width,this.height),this.renderer.ctx.save(),this.renderer.ctx.fillStyle=this.backgroundColor,this.renderer.ctx.fillRect(0,0,this.width,this.height),this.renderer.ctx.translate(this.width/2,this.height/2),this.renderer.ctx.scale(1,-1),t.sort((t,e)=>t.index-e.index).forEach(t=>{t.faces.forEach(e=>this.drawFace(e,t.fill)),t.edges.forEach(e=>this.drawEdge(e,t.stroke))}),this.renderer.ctx.restore()}drawFace(t,e){let i,r,{points:s,normal:n}=t,{r:o,g:h,b:a}=p(e);n[2]>0&&(i=(1+d.cos(this.light,n))/2*.5+.4,r=`rgba(${o*i}, ${h*i}, ${a*i}, 1)`,this.renderer.polygone(s),this.renderer.ctx.fillStyle=r,this.renderer.ctx.fill())}drawEdge(t){let{points:e}=t;this.renderer.ctx.beginPath(),this.renderer.polyline(e),this.renderer.ctx.strokeStyle="#ccc",this.renderer.ctx.stroke(),this.renderer.ctx.beginPath()}add(t){this.elements.includes(t)||this.elements.push(t)}setPosition(t,e){this.x=t,this.y=e}setSize(t,e){this.width=t,this.height=e,this.renderer.dom.width=t,this.renderer.dom.height=e,this.renderer.dom.style.width=t+"px",this.renderer.dom.style.height=e+"px"}setLight(t=1,e=1,i=1){this.light[0]=t,this.light[1]=e,this.light[2]=i}getRenderElements(){let t=[];return this.elements.forEach(e=>{let i,r=[],n=[],o=[];e.vertexes.forEach(t=>{let e=this.coordTransform(s(...t));r.push(e),(void 0===i||e[2]<i)&&(i=e[2])}),e.faces&&e.faces.length&&e.faces.forEach(t=>{let e=t.map(t=>r[t]),i=d.normalVector(e);n.push({points:e,normal:i})}),e.edges&&e.edges.length&&e.edges.forEach(t=>{o.push({points:t.map(t=>r[t])})}),t.push({index:i,faces:n,edges:o,fill:e.fill,stroke:e.stroke})}),t}coordTransform(t){t.rotate(this.rotationZ),t.rotateX(this.rotationX),t.translate(this.x,-this.y);let{x:e,y:i,z:r}=t,s=this.width/this.perspective*(1+r/this.perspective);return[e*s,i*s,r]}},Cubic:class extends g{constructor(t=0,e=0,i=0,r=1,s=1,n=1){super(),this.stroke="rgba(0, 0, 0, .5)",this.fill="rgba(200, 200, 200, 1)",this.vertexes=[[0,0,0],[r,0,0],[r,s,0],[0,s,0],[0,0,n],[r,0,n],[r,s,n],[0,s,n]].map(o=>{let[h,a,l]=o;return[h-r/2+t,a-s/2+e,l-n/2+i]}),this.edges=[],this.faces=[[0,3,2,1],[0,1,5,4],[1,2,6,5],[2,3,7,6],[3,0,4,7],[4,5,6,7]]}},animate:function(t,e,i){let r={},s={};Object.keys(e).forEach(i=>{isNaN(e[i])||isNaN(t[i])||(r[i]=t[i],s[i]=e[i]-t[i])});let n=new y;return Object.assign(n,{data:{obj:t,originalStatus:r,deltas:s},...i}),n.play(),n}},b=new w.Scene;b.perspective=1300,b.rotationX=35,b.rotationZ=120,b.backgroundColor="rgba(0, 0, 0, 1)",b.setSize(window.innerWidth,window.innerHeight),b.setPosition(-100,100,0),document.body.appendChild(b.renderer.dom);var v=new w.Cubic(0,-50,200,130,150,400),M=new w.Cubic(10,160,120,110,110,240),S=new w.Cubic(10,290,60,110,150,120),P=new w.Cubic(-65,265,15,40,200,30);b.add(P),b.add(S),b.add(M),b.add(v),b.render(),window.onmousewheel=function(t){let e=t.wheelDelta<0?1.1:1/1.1;b.perspective*=e};let E=0,O=0,X=window.innerWidth/2,j=window.innerHeight/2,k=!1;window.onmousedown=function(t){k=!0,E=t.pageX,O=t.pageY},window.onmousemove=function(t){if(k&&(t.pageX!==E||t.pageY!==O)){if(t.shiftKey){let[e,i]=[E-X,O-j],[r,s]=[t.pageX-X,t.pageY-j],n=e*s>i*r,o=Math.acos((e*r+i*s)/Math.sqrt(e*e+i*i)/Math.sqrt(r*r+s*s));o=o/Math.PI*180,b.rotationZ+=n?o:-o}else t.metaKey?b.rotationX+=t.pageY<O?5:t.pageY>O?-5:0:(b.x+=t.pageX-E,b.y+=t.pageY-O);E=t.pageX,O=t.pageY}},window.onmouseup=function(t){console.log(b.rotationZ,b.rotationX),t.preventDefault(),k=!1}}]);