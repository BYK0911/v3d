!function(t){var e={};function i(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(r,s,function(e){return t[e]}.bind(null,s));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class r{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}matrix(t,e,i,r,s,n,o,h,a,l,c,d){let{x:u,y:p,z:f}=this;this.x=t*u+e*p+i*f+r,this.y=s*u+n*p+o*f+h,this.z=a*u+l*p+c*f+d}translate(t=0,e=0,i=0){this.x+=t,this.y+=e,this.z+=i}rotate(t=0){t=t/180*Math.PI;let e=Math.cos(t),i=Math.sin(t);this.matrix(e,i,0,0,-i,e,0,0,0,0,1,0)}rotateX(t=0){t=t/180*Math.PI;let e=Math.cos(t),i=Math.sin(t);this.matrix(1,0,0,0,0,e,i,0,0,-i,e,0)}rotateY(t=0){t=t/180*Math.PI;let e=Math.cos(t),i=Math.sin(t);this.matrix(e,0,-i,0,0,1,0,0,i,0,e,0)}}var s=class{constructor(){this.dom=document.createElement("canvas"),this.ctx=this.dom.getContext("2d")}polyline(t){t.forEach((t,e)=>{0===e?this.ctx.moveTo(...t):this.ctx.lineTo(...t)})}polygone(t){this.ctx.beginPath(),this.polyline(t),this.ctx.closePath()}};function n(t=[]){let e=t.length;if(e<=1)return t;if(e=2){let[[e,i],[r,s]]=t;return e*s-i*r}{let i=0,r=0;for(;i<e;)r+=o(t,0,i);return r}}function o(t,e,i){return 0===t[e][i]?0:Math.pow(-1,e+i)*t[e][i]*n(h(t,e,i))}function h(t,e,i){let r=t.length,s=[];for(let n=0;n<r;n++){if(n===e)continue;let o=[];for(let e=0;e<r;e++)e!==i&&o.push(t[n][e]);s.push(o)}return s}var a={det:n,A:o,M:h};let{A:l}=a;var c={add(...t){let e=[];return t.forEach(t=>{t.forEach((t,i)=>{e[i]=e[i]?e[i]+t:t})}),e},minus(t,e){let i=[...t];e.forEach((t,e)=>{i[e]=(i[e]||0)-t})},norm(t){if(0!==t.length)return Math.sqrt(t.reduce((t,e)=>t+e*e,0))},dot(t,e){let i=Math.min(t.length,e.length),r=0,s=-1;for(;++s<i;)r+=t[s]*e[s];return r},cross(t,e){let[i,r,s]=t,[n,o,h]=e;void 0===s&&(s=0),void 0===h&&(h=0);let a=[[1,1,1],[i,r,s],[n,o,h]];return[l(a,0,0),l(a,0,1),l(a,0,2)]},scale:(t,e)=>t.map(t=>t*e),cos(t,e){let i=this.norm(t),r=this.norm(e);return i&&r?this.dot(t,e)/i/r:1},sin(t,e){let i=this.norm(t),r=this.norm(e);return i&&r?this.norm(this.cross(t,e))/i/r:1},normalVector(t){let e=[0,0,0],i=-1;for(t=[...t,t[0]];++i<t.length-1;)e=this.add(e,this.cross(t[i],t[i+1]));return e}};const d={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15};var u=function(t){let e,i,r,s=1;if("#"===t[0]){let s=t.slice(1);3===s.length&&(s=`${s[0]}${s[0]}${s[1]}${s[1]}${s[2]}${s[2]}`),e=16*d[s[0]]+d[s[1]],i=16*d[s[2]]+d[s[3]],r=16*d[s[4]]+d[s[5]]}else t.match(/rgba/)?[e,i,r,s]=t.slice(5,-1).split(/,\s*/g):[e,i,r]=t.slice(4,-1).split(/,\s*/g);return{r:e,g:i,b:r,a:s}};var p=class{constructor(){this.x=0,this.y=0,this.width=500,this.height=300,this.rotationX=0,this.rotationZ=0,this.perspective=100,this.light=[1,1,1],this.backgroundColor="rgba(255, 255, 255, 0)",this.elements=[],this.renderer=new s}render(){window.requestAnimationFrame(()=>this.render());let t=this.getRenderElements();this.renderer.ctx.clearRect(0,0,this.width,this.height),this.renderer.ctx.save(),this.renderer.ctx.fillStyle=this.backgroundColor,this.renderer.ctx.fillRect(0,0,this.width,this.height),this.renderer.ctx.translate(this.width/2,this.height/2),this.renderer.ctx.scale(1,-1),t.sort((t,e)=>t.index-e.index).forEach(t=>{t.faces.forEach(e=>this.drawFace(e,t.fill)),t.edges.forEach(e=>this.drawEdge(e,t.stroke))}),this.renderer.ctx.restore()}drawFace(t,e){let i,r,{points:s,normal:n}=t,{r:o,g:h,b:a}=u(e);n[2]>0&&(i=(1+c.cos(this.light,n))/2*.5+.4,r=`rgba(${o*i}, ${h*i}, ${a*i}, 1)`,this.renderer.polygone(s),this.renderer.ctx.fillStyle=r,this.renderer.ctx.fill())}drawEdge(t){let{points:e}=t;this.renderer.ctx.beginPath(),this.renderer.polyline(e),this.renderer.ctx.strokeStyle="#ccc",this.renderer.ctx.stroke(),this.renderer.ctx.beginPath()}add(t){this.elements.includes(t)||this.elements.push(t)}setPosition(t,e){this.x=t,this.y=e}setSize(t,e){this.width=t,this.height=e,this.renderer.dom.width=t,this.renderer.dom.height=e,this.renderer.dom.style.width=t+"px",this.renderer.dom.style.height=e+"px"}setLight(t=1,e=1,i=1){this.light[0]=t,this.light[1]=e,this.light[2]=i}getRenderElements(){let t=[];return this.elements.forEach(e=>{let i,s=[],n=[],o=[];e.vertexes.forEach(t=>{let e=this.coordTransform(function(t,e,i){return new r(t,e,i)}(...t));s.push(e),(void 0===i||e[2]<i)&&(i=e[2])}),e.faces&&e.faces.length&&e.faces.forEach(t=>{let e=t.map(t=>s[t]),i=c.normalVector(e);n.push({points:e,normal:i})}),e.edges&&e.edges.length&&e.edges.forEach(t=>{o.push({points:t.map(t=>s[t])})}),t.push({index:i,faces:n,edges:o,fill:e.fill,stroke:e.stroke})}),t}coordTransform(t){t.rotate(this.rotationZ),t.rotateX(this.rotationX),t.translate(this.x,-this.y);let{x:e,y:i,z:r}=t,s=this.width/this.perspective*(1+r/this.perspective);return[e*s,i*s,r]}};var f=class{constructor(){this.x=0,this.y=0,this.fill="rgba(255, 255, 255, 0)",this.stroke="rgba(0, 0, 0, .5)",this.lineWidth=1}render(){}setPosition(t,e){this.x=t,this.y=e}};var g=class extends f{constructor(t=0,e=0,i=0,r=1,s=1,n=1){super(),this.stroke="rgba(0, 0, 0, .5)",this.fill="rgba(200, 200, 200, 1)",this.vertexes=[[0,0,0],[r,0,0],[r,s,0],[0,s,0],[0,0,n],[r,0,n],[r,s,n],[0,s,n]].map(o=>{let[h,a,l]=o;return[h-r/2+t,a-s/2+e,l-n/2+i]}),this.edges=[],this.faces=[[0,3,2,1],[0,1,5,4],[1,2,6,5],[2,3,7,6],[3,0,4,7],[4,5,6,7]]}};const m=[],y={linear:t=>t,ease:t=>t*t,easeOut:t=>Math.sqrt(t)};class x{constructor(){this.duration=300,this.delay=0,this.timingFunction="ease",this.data=null,this.timeStart=null,this.playing=!1,this.timePaused=null,this.loop=1,this.direction="normal"}run(){let t=+new Date;if(t-this.timeStart>this.delay){let e,i=(t-this.timeStart-this.delay)/this.duration,r=this.timingFunction,{obj:s,originalStatus:n,deltas:o}=this.data;i>1&&(--this.loop?(i-=1,this.timeStart+=this.duration):(i=1,m.splice(m.indexOf(this),1),this.playing=!1)),"string"==typeof r&&(r=y[r]||y.ease),e=r(i);for(let t in o)s[t]=n[t]+o[t]*e}}play(){return!this.playing&&this.loop>0&&(this.playing=!0,this.timeStart||(this.timeStart=+new Date),this.timePaused&&(this.timeStart+=+new Date-this.timePaused),m.push(this),1===m.length&&w()),this}pause(){return this.playing&&(m.splice(m.indexOf(this),1),this.playing=!1,this.timePaused=+new Date),this}delay(t=0){return this.delay=t,this}loop(t=1){return this.loop=t,this}restart(t){this.loop=t?Math.max(t,1):Math.max(this.loop,1),this.timeStart=null,this.timePaused=null,this.play()}}function w(){m.length&&requestAnimationFrame(w),m.forEach(t=>{t.run()})}var b={Scene:p,Cubic:g,animate:function(t,e,i){let r={},s={};Object.keys(e).forEach(i=>{isNaN(e[i])||isNaN(t[i])||(r[i]=t[i],s[i]=e[i]-t[i])});let n=new x;return Object.assign(n,{data:{obj:t,originalStatus:r,deltas:s},...i}),n.play(),n}},v=new b.Scene;v.perspective=1300,v.rotationX=65,v.rotationZ=126,v.backgroundColor="rgba(0, 0, 0, 1)",v.setSize(window.innerWidth,window.innerHeight),v.setPosition(-112,140,0),document.body.appendChild(v.renderer.dom);var M=new b.Cubic(0,-50,200,130,150,400),S=new b.Cubic(10,160,120,110,110,240),P=new b.Cubic(10,290,60,110,150,120),E=new b.Cubic(-65,265,15,40,200,30);v.add(E),v.add(P),v.add(S),v.add(M),v.render(),window.onmousewheel=function(t){let e=t.wheelDelta<0?1.1:1/1.1;v.perspective*=e};let O=0,j=0,k=window.innerWidth/2,C=window.innerHeight/2,X=!1;window.onmousedown=function(t){X=!0,O=t.pageX,j=t.pageY},window.onmousemove=function(t){if(X&&(t.pageX!==O||t.pageY!==j)){if(t.shiftKey){let[e,i]=[O-k,j-C],[r,s]=[t.pageX-k,t.pageY-C],n=e*s>i*r,o=Math.acos((e*r+i*s)/Math.sqrt(e*e+i*i)/Math.sqrt(r*r+s*s));o=o/Math.PI*180,v.rotationZ+=n?o:-o}else t.metaKey?v.rotationX+=t.pageY<j?5:t.pageY>j?-5:0:(v.x+=t.pageX-O,v.y+=t.pageY-j);O=t.pageX,j=t.pageY}},window.onmouseup=function(t){t.preventDefault(),console.log(v),X=!1};var z=document.createElement("div");z.innerHTML="拖动移动图形位置；<br>按下Shift键拖动 延z轴旋转；<br>按下Command或Window键 延x轴旋转；",z.style.position="fixed",z.style.top="0",z.style.left="0",z.style.width="100%",z.style.color="#fff",z.style.fontSize="12px",z.style.padding="10px",z.style.textAlign="center",document.body.append(z)}]);